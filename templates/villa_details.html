{% extends 'base.html' %}
{% block content %}

<style>
    /* üè∑Ô∏è Discount Tag Style */
    .detail-discount-tag {
        position: absolute; top: 15px; right: 15px; z-index: 30;
        background: #0d6efd; color: white; padding: 6px 15px;
        border-radius: 50px; font-weight: 800; font-size: 0.9rem;
        box-shadow: 0 4px 15px rgba(13, 110, 253, 0.3);
    }

    /* Price Styling */
    .price-request-bold { color: #0d6efd; font-weight: 800; font-size: 1.8rem; text-transform: uppercase; letter-spacing: 1px; }
    .original-price-cut { text-decoration: line-through; color: #adb5bd; font-weight: 400; font-size: 1.2rem; margin-right: 10px; }
    .current-price-main { color: #0d6efd; font-weight: 800; font-size: 2rem; }

    /* Sticky Mobile Footer */
    @media (max-width: 767px) {
        .sticky-booking-bar {
            position: fixed; bottom: 0; left: 0; right: 0;
            background: white; padding: 15px 25px;
            box-shadow: 0 -10px 30px rgba(0,0,0,0.08);
            z-index: 1000; display: flex;
            justify-content: space-between; align-items: center;
            border-top: 1px solid #eee;
        }
        body { padding-bottom: 90px; } 
    }
    @media (min-width: 768px) { .sticky-booking-bar { display: none; } }

    .carousel-item img { height: 500px; object-fit: cover; border-radius: 20px; }
    @media (max-width: 768px) { .carousel-item img { height: 300px; } }

    .rule-item { border-left: 3px solid #0d6efd; padding-left: 15px; margin-bottom: 15px; background: #f8f9fa; padding-top: 10px; padding-bottom: 10px; border-radius: 0 10px 10px 0; }
    
    .info-card { background: #f0f7ff; border: 1px solid #cfe2ff; border-radius: 15px; padding: 20px; }
</style>

<div class="container py-4">
    <div id="villaSlider" class="carousel slide shadow-lg position-relative" data-bs-ride="carousel" style="border-radius: 25px; overflow: hidden;">
        {% set current = (villa.Price or 0) | float %}
        {% set original = (villa.Original_Price or 0) | float %}
        
        {% if original > current and current > 0 %}
            {% set disc = (((original - current) / original) * 100) | round | int %}
            <div class="detail-discount-tag">üî• {{ disc }}% OFF TODAY</div>
        {% endif %}

        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="{{ villa.Image_URL or villa.Image_URL_1 }}" class="d-block w-100" alt="Main">
            </div>
            {% if villa_images %}
                {% for img_url in villa_images %}
                    {% if img_url != villa.Image_URL and img_url != villa.Image_URL_1 %}
                    <div class="carousel-item">
                        <img src="{{ img_url }}" class="d-block w-100" alt="Gallery">
                    </div>
                    {% endif %}
                {% endfor %}
            {% endif %}
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#villaSlider" data-bs-slide="prev"><span class="carousel-control-prev-icon"></span></button>
        <button class="carousel-control-next" type="button" data-bs-target="#villaSlider" data-bs-slide="next"><span class="carousel-control-next-icon"></span></button>
    </div>

    <div class="row mt-5">
        <div class="col-md-8">
            <div class="d-flex align-items-center mb-2">
                <span class="badge bg-primary-subtle text-primary border border-primary-subtle rounded-pill px-3 py-1 me-2 small fw-bold">LUXURY STAY</span>
                <small class="text-muted"><i class="bi bi-geo-alt-fill text-danger"></i> Lonavala, Maharashtra</small>
            </div>
            <h1 class="fw-extrabold text-dark mb-4" style="font-weight: 800;">{{ villa.Villa_Name }}</h1>

            <div class="mb-5 py-3 border-top border-bottom">
                {% if current > 0 %}
                    <span class="text-muted small d-block mb-1">Nightly Rate</span>
                    <div class="d-flex align-items-baseline">
                        {% if original > current %}
                            <span class="original-price-cut">‚Çπ{{ "{:,}".format(original | int) }}</span>
                        {% endif %}
                        <span class="current-price-main">‚Çπ{{ "{:,}".format(current | int) }}</span>
                        <small class="text-muted ms-2 fs-6">/ night</small>
                    </div>
                {% else %}
                    <div class="price-request-bold">Price on Request</div>
                {% endif %}
            </div>

            <div class="row g-3 mb-5">
                <div class="col-4 col-md-3">
                    <div class="text-center p-3 border rounded-4 bg-white shadow-sm">
                        <i class="bi bi-people fs-3 text-primary"></i>
                        <div class="small fw-bold mt-1">{{ villa.Guests }} Guests</div>
                    </div>
                </div>
                <div class="col-4 col-md-3">
                    <div class="text-center p-3 border rounded-4 bg-white shadow-sm">
                        <i class="bi bi-door-open fs-3 text-primary"></i>
                        <div class="small fw-bold mt-1">{{ villa.BHK }} BHK</div>
                    </div>
                </div>
                <div class="col-4 col-md-3">
                    <div class="text-center p-3 border rounded-4 bg-white shadow-sm">
                        <i class="bi bi-droplet fs-3 text-primary
                            
