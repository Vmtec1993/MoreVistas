{% extends 'base.html' %}
{% block content %}

<style>
    /* üè∑Ô∏è Discount Tag Style (Image ke upar) */
    .detail-discount-tag {
        position: absolute; top: 15px; right: 15px; z-index: 99;
        background: #28a745; color: white; padding: 6px 12px;
        border-radius: 10px; font-weight: 800; font-size: 0.9rem;
        box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }
    
    /* Carousel fixed height for mobile & desktop */
    #villaSlider img { height: 350px; object-fit: cover; }
    
    /* üñ§ Social Footer Styling */
    .final-footer { background: #1a1a1a; color: #ffffff; padding: 60px 0 0; text-align: center; margin-top: 60px; }
    .footer-logo-img { height: 75px; width: auto; margin-bottom: 20px; }
    .social-icons a { color: white; font-size: 1.8rem; margin: 0 15px; transition: 0.3s; display: inline-block; }
    .social-icons a:hover { transform: translateY(-5px); }
    .bi-whatsapp:hover { color: #25D366; }
    .bi-instagram:hover { color: #E1306C; }
    .bi-facebook:hover { color: #1877F2; }
    .footer-bottom { background: #141414; padding: 30px 0; margin-top: 40px; border-top: 1px solid #222; }
</style>

<div class="container py-4">
    <div id="villaSlider" class="carousel slide shadow-sm position-relative" data-bs-ride="carousel" style="border-radius: 20px; overflow: hidden;">
        
        {% set current = (villa.Price or 0) | float %}
        {% set original = (villa.Original_Price or 0) | float %}
        {% if original > current and current > 0 %}
            {% set disc = (((original - current) / original) * 100) | round | int %}
            <div class="detail-discount-tag">{{ disc }}% OFF</div>
        {% endif %}

        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="{{ villa.Image_URL }}" class="d-block w-100">
            </div>

            {% if villa_images %}
                {% for img_link in villa_images %}
                    {% if img_link != villa.Image_URL %}
                    <div class="carousel-item">
                        <img src="{{ img_link }}" class="d-block w-100">
                    </div>
                    {% endif %}
                {% endfor %}
            {% endif %}
        </div>
        
        <button class="carousel-control-prev" type="button" data-bs-target="#villaSlider" data-bs-slide="prev"><span class="carousel-control-prev-icon"></span></button>
        <button class="carousel-control-next" type="button" data-bs-target="#villaSlider" data-bs-slide="next"><span class="carousel-control-next-icon"></span></button>
    </div>

    <div class="mt-4 px-2">
        <div class="d-flex justify-content-between align-items-start mb-2">
            <div>
                <h2 class="fw-bold m-0 text-dark">{{ villa.Villa_Name }}</h2>
                <div class="mt-1">
                    <span class="badge {% if villa.Status == 'Available' %}bg-success{% else %}bg-warning text-dark{% endif %} rounded-pill small">
                        {{ villa.Status | default('Available') }}
                    </span>
                    <small class="text-muted ms-2"><i class="bi bi-geo-alt-fill text-danger"></i> Lonavala</small>
                </div>
            </div>
            
            {% if villa.Offer_End and villa.Offer_End|string != 'nan' and villa.Offer_End != '' %}
            <div class="text-center">
                <div class="badge bg-danger mb-1 shadow-sm">Ends Soon!</div>
                <div class="text-danger fw-bold" style="font-size: 0.75rem;">
                    <i class="bi bi-clock-history"></i> <span id="sheet-timer" data-expire="{{ villa.Offer_End }}">Loading...</span>
                </div>
            </div>
            {% endif %}
        </div>

        <div class="card border-0 bg-light rounded-4 p-3 my-4">
            <div class="row align-items-center">
                <div class="col-7">
                    <span class="text-muted small d-block">Starting from</span>
                    {% if villa.Original_Price and villa.Original_Price|string != 'nan' and villa.Original_Price != '' %}
                    <span class="text-decoration-line-through text-muted small">‚Çπ{{ villa.Original_Price }}</span>
                    {% endif %}
                    <h3 class="fw-bold text-primary mb-0">‚Çπ{{ villa.Price }} <small class="text-muted fs-6 fw-normal">/night</small></h3>
                </div>
                <div class="col-5">
                    <a href="/enquiry/{{ villa.Villa_ID }}" class="btn btn-primary w-100 rounded-pill py-2 fw-bold shadow-sm">Reserve</a>
                </div>
            </div>
        </div>

        </div>
</div>

<footer class="final-footer">
    </footer>

{% endblock %}
