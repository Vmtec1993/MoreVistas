{% extends 'base.html' %}
{% block content %}

<style>
    /* Premium Typography & Colors */
    .villa-title-detail {
        background: linear-gradient(45deg, #ff416c, #ff4b2b);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        font-weight: 850; font-size: 2.2rem;
    }
    .carousel-item img { height: 500px; object-fit: cover; border-radius: 20px; }
    @media (max-width: 768px) { .carousel-item img { height: 280px; } .villa-title-detail { font-size: 1.8rem; } }

    .highlight-badge-card { 
        background: #ffffff; 
        border: 1px solid #eee; 
        border-radius: 15px; 
        padding: 12px; 
        text-align: center; 
        box-shadow: 0 4px 10px rgba(0,0,0,0.03);
    }
    
    /* Rules Vertical List Style - FIXED (Line-by-Line alignment) */
    .rule-item-box { 
        display: flex; /* Yahan Flex kiya taaki rule niche na dabe */
        align-items: flex-start;
        width: 100%;
        background: #fff; 
        padding: 15px; 
        border: 1px solid #eee;
        border-left: 5px solid #ff4757;
        border-radius: 8px; 
        margin-bottom: 12px; 
        font-size: 0.95rem; 
        font-weight: 500;
        box-shadow: 0 2px 5px rgba(0,0,0,0.02);
        transition: 0.3s;
    }
    .rule-item-box:hover { transform: translateX(5px); box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
    .rule-icon-fix { color: #ff4757; margin-right: 12px; font-size: 1.2rem; flex-shrink: 0; line-height: 1; }
    
    .detail-original-price { text-decoration: line-through; color: #adb5bd; font-size: 1.1rem; }
    .savings-badge { background: #28a745; color: white; padding: 4px 12px; border-radius: 5px; font-size: 0.85rem; font-weight: bold; }
    .offer-banner { position: absolute; top: 20px; left: 20px; z-index: 10; background: #ff4757; color: white; padding: 5px 15px; border-radius: 50px; font-weight: 800; font-size: 0.8rem; }

    /* Mobile Booking Bar */
    @media (max-width: 767px) {
        .mobile-booking-bar {
            position: fixed; bottom: 0; left: 0; right: 0; background: white;
            padding: 10px 20px; box-shadow: 0 -5px 20px rgba(0,0,0,0.1);
            z-index: 1000; display: flex; justify-content: space-between; align-items: center;
        }
        body { padding-bottom: 70px; }
    }
</style>

<div class="container py-4">
    <div id="villaSlider" class="carousel slide shadow-sm position-relative mb-4" data-bs-ride="carousel" style="border-radius: 20px; overflow: hidden;">
        {% if villa.Original_Price|int > villa.Price|int %}
            <div class="offer-banner">ðŸ”¥ SPECIAL OFFER LIVE</div>
        {% endif %}
        
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="{{ villa.Image_URL }}" class="d-block w-100" alt="Main Image">
            </div>
            {% for img in villa_images %}
                {% if img != villa.Image_URL %}
                <div class="carousel-item">
                    <img src="{{ img }}" class="d-block w-100" alt="Gallery">
                </div>
                {% endif %}
            {% endfor %}
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#villaSlider" data-bs-slide="prev"><span class="carousel-control-prev-icon"></span></button>
        <button class="carousel-control-next" type="button" data-bs-target="#villaSlider" data-bs-slide="next"><span class="carousel-control-next-icon"></span></button>
    </div>

    <div class="row">
        <div class="col-md-8">
            <h1 class="villa-title-detail mb-1">{{ villa.Villa_Name }}</h1>
            <p class="text-muted mb-4"><i class="bi bi-geo-alt-fill text-danger"></i> Lonavala, Maharashtra</p>

            <div class="row g-3 mb-5">
                <div class="col-4 text-center">
                    <div class="highlight-badge-card">
                        <i class="bi bi-people fs-3 text-primary"></i>
                        <div class="fw-bold small mt-1">{{ villa.Guests }} Guests</div>
                    </div>
                </div>
                <div class="col-4 text-center">
                    <div class="highlight-badge-card">
                        <i class="bi bi-door-open fs-3 text-primary"></i>
                        <div class="fw-bold small mt-1">{{ villa.BHK }} BHK</div>
                    </div>
                </div>
                <div class="col-4 text-center">
                    <div class="highlight-badge-card">
                        <i class="bi bi-water fs-3 text-primary"></i>
                        <div class="fw-bold small mt-1">Private Pool</div>
                    </div>
                </div>
            </div>

            <div class="description-section mb-5">
                <h4 class="fw-bold mb-3">âœ¨ Experience Private Pool Luxury</h4>
                <p class="text-secondary" style="line-height: 1.7; font-size: 1.05rem;">
                    Welcome to <b>{{ villa.Villa_Name }}</b> â€” a beautifully designed escape crafted for peaceful mountain getaways. 
                    Spend your day relaxing by your private pool and enjoy the cool mountain air of Lonavala. 
                    Perfect for families and friends looking for exclusivity and luxury.
                </p>
            </div>

            <div class="rules-section mb-5">
                <h4 class="fw-bold mb-4"><i class="bi bi-shield-check text-primary me-2"></i>Stay Rules</h4>
                <div class="d-flex flex-column">
                    {% if villa.Rules_List %}
                        {% for rule in villa.Rules_List %}
                            {% if rule.strip() %}
                            <div class="rule-item-box">
                                <i class="bi bi-check-circle-fill rule-icon-fix"></i> 
                                <span>{{ rule.strip() }}</span>
                            </div>
                            {% endif %}
                        {% endfor %}
                    {% else %}
                        <div class="rule-item-box">Standard villa rules apply. Contact owner for details.</div>
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="card border-0 shadow-lg rounded-4 p-4 sticky-top" style="top: 100px; z-index: 10;">
                <h5 class="fw-bold mb-3">Pricing & Booking</h5>
                
                {% if villa.Price and villa.Price|int > 0 %}
                    <div class="mb-3">
                        {% if villa.Original_Price|int > villa.Price|int %}
                            <div class="d-flex align-items-center mb-1">
                                <span class="detail-original-price me-2">â‚¹{{ villa.Original_Price }}</span>
                                <span class="savings-badge">
                                    {{ (((villa.Original_Price|int - villa.Price|int) / villa.Original_Price|int) * 100)|int }}% OFF
                                </span>
                            </div>
                        {% endif %}
                        <div class="d-flex align-items-baseline">
                            <span class="fs-1 fw-bold text-primary">â‚¹{{ villa.Price|int }}</span>
                            <span class="text-muted ms-2">/ night</span>
                        </div>
                    </div>
                {% else %}
                    <h3 class="text-primary fw-bold mb-4">Price on Request</h3>
                {% endif %}

                <div class="d-grid gap-3 mt-4">
                    <a href="https://wa.me/918830024994?text=Hi,%20I%20am%20interested%20in%20booking%20{{ villa.Villa_Name|urlencode }}" class="btn btn-success rounded-pill py-3 fw-bold shadow-sm">
                        <i class="bi bi-whatsapp me-2"></i>BOOK ON WHATSAPP
                    </a>
                    
                    <a href="/enquiry/{{ villa.Villa_ID }}" class="btn btn-outline-primary rounded-pill py-3 fw-bold">
                        <i class="bi bi-envelope-paper me-2"></i>FILL ENQUIRY FORM
                    </a>
                </div>

                <div class="mt-4 p-3 bg-light rounded-3 text-center border">
                    <h6 class="fw-bold text-success mb-1">âš¡ 100% Verified Villa</h6>
                    <small class="text-muted">Direct Booking â€¢ Best Price</small>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="mobile-booking-bar d-md-none">
    <div style="flex: 1;">
        {% if villa.Price and villa.Price|int > 0 %}
            <div class="fw-bold fs-4 text-primary">â‚¹{{ villa.Price|int }}</div>
            <small class="text-muted">per night</small>
        {% else %}
            <div class="fw-bold text-primary">Contact Us</div>
        {% endif %}
    </div>
    <div style="display: flex; gap: 10px;">
        <a href="/enquiry/{{ villa.Villa_ID }}" class="btn btn-outline-primary rounded-pill px-3 py-2 fw-bold">
            <i class="bi bi-pencil-square"></i>
        </a>
        <a href="https://wa.me/918830024994?text=I%20want%20to%20book%20{{ villa.Villa_Name|urlencode }}" class="btn btn-success rounded-pill px-4 py-2 fw-bold shadow">
            <i class="bi bi-whatsapp"></i> BOOK
        </a>
    </div>
</div>

{% endblock %}
